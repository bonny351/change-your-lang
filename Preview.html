<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spa Music Player</title>

<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  font-family:"Segoe UI",sans-serif;
  background:#061b1a;
  overflow:hidden;
  color:#eafff7;
}

/* BACKGROUND */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at top,rgba(0,255,200,.25),transparent 60%),
    radial-gradient(circle at bottom,rgba(0,80,60,.8),#020b0a);
}

/* WAVES */
canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}

/* PLAYER */
#player{
  position:relative;
  z-index:2;
  max-width:1200px;
  margin:40px auto;
  padding:30px;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(18px);
  border-radius:30px;
}

/* HEADER */
#header{
  display:flex;
  align-items:center;
  gap:20px;
}
#avatar{
  width:80px;
  height:80px;
  border-radius:50%;
  background:linear-gradient(135deg,#2bffc6,#0a4f3a);
  box-shadow:0 0 30px #2bffc6;
}
#nowPlaying{
  font-size:32px;
  flex:1;
}

/* SONG INFO */
#songInfo{
  display:flex;
  gap:20px;
  margin-top:25px;
}
#cover{
  width:180px;
  height:180px;
  border-radius:14px;
  background:linear-gradient(135deg,#1cffb3,#0a3a30);
}
#details h2{margin:0;font-size:28px}
#details p{margin:6px 0;color:#b7fff0}

/* PROGRESS */
#progressWrap{
  margin-top:20px;
}
#progress{
  width:100%;
  height:6px;
  background:rgba(255,255,255,.15);
  border-radius:6px;
  overflow:hidden;
}
#bar{
  width:0%;
  height:100%;
  background:#2bffc6;
  box-shadow:0 0 12px #2bffc6;
}

/* CONTROLS */
#controls{
  display:flex;
  justify-content:center;
  gap:30px;
  margin:25px 0;
}
.ctrl{
  width:70px;
  height:70px;
  border-radius:50%;
  background:rgba(43,255,198,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  cursor:pointer;
}
.ctrl:hover{background:rgba(43,255,198,.45)}

/* PLAYLISTS */
#lists{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:25px;
}
.panel{
  background:rgba(0,255,200,.1);
  border-radius:20px;
  padding:18px;
}
.panel h3{margin-top:0}
.track{
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,.1);
  cursor:pointer;
}
.track:hover{color:#2bffc6}

/* FOOTER */
#footer{
  display:flex;
  justify-content:space-between;
  margin-top:20px;
}
button{
  padding:14px 28px;
  border-radius:16px;
  border:none;
  background:rgba(43,255,198,.25);
  color:white;
  font-size:16px;
  cursor:pointer;
}
button:hover{background:rgba(43,255,198,.45)}
</style>
</head>

<body>

<canvas id="waves"></canvas>

<div id="player">
  <div id="header">
    <div id="avatar"></div>
    <div id="nowPlaying">Now Playing for Isaiah</div>
  </div>

  <div id="songInfo">
    <div id="cover"></div>
    <div id="details">
      <h2 id="songTitle">No Song Playing</h2>
      <p id="artist">Select a track</p>
    </div>
  </div>

  <div id="progressWrap">
    <div id="progress"><div id="bar"></div></div>
  </div>

  <div id="controls">
    <div class="ctrl" onclick="prev()">⏮</div>
    <div class="ctrl" onclick="toggle()">⏯</div>
    <div class="ctrl" onclick="next()">⏭</div>
  </div>

  <div id="lists">
    <div class="panel">
      <h3>Isaiah’s Playlist</h3>
      <input type="file" accept=".mp3" multiple onchange="addFiles(this.files)">
      <div id="playlist"></div>
    </div>
    <div class="panel">
      <h3>Chill Out Mix</h3>
      <div style="opacity:.6">Add your own MP3s</div>
    </div>
  </div>

  <div id="footer">
    <button onclick="shuffle()">Shuffle</button>
    <button onclick="location.reload()">Back to Profiles</button>
  </div>
</div>

<audio id="audio"></audio>

<script>
/* AUDIO */
const audio=document.getElementById("audio");
let tracks=[],current=0;

/* ONE audio context ONLY */
const ctx=new (window.AudioContext||window.webkitAudioContext)();
const analyser=ctx.createAnalyser();
const source=ctx.createMediaElementSource(audio);
source.connect(analyser);
analyser.connect(ctx.destination);

/* PLAY */
function play(i){
  current=i;
  audio.src=tracks[i].src;
  ctx.resume();
  audio.play();
  songTitle.textContent=tracks[i].name;
}
function toggle(){audio.paused?audio.play():audio.pause()}
function next(){tracks.length&&play((current+1)%tracks.length)}
function prev(){tracks.length&&play((current-1+tracks.length)%tracks.length)}
function shuffle(){
  tracks.sort(()=>Math.random()-.5);
  render();
}

/* FILES */
function addFiles(files){
  for(const f of files){
    tracks.push({name:f.name.replace(".mp3",""),src:URL.createObjectURL(f)});
  }
  render();
}

/* RENDER */
function render(){
  playlist.innerHTML="";
  tracks.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="track";
    d.textContent=t.name;
    d.onclick=()=>play(i);
    playlist.appendChild(d);
  });
}

/* PROGRESS */
audio.ontimeupdate=()=>{
  bar.style.width=(audio.currentTime/audio.duration*100||0)+"%";
};

/* WAVES */
const c=document.getElementById("waves");
const x=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();onresize=resize;

let t=0;
function draw(){
  x.clearRect(0,0,c.width,c.height);
  analyser.getByteFrequencyData(new Uint8Array(analyser.frequencyBinCount));
  x.beginPath();
  for(let i=0;i<c.width;i+=8){
    x.lineTo(i,c.height/2+Math.sin(i/150+t)*30);
  }
  x.strokeStyle="rgba(43,255,198,.2)";
  x.lineWidth=3;
  x.stroke();
  t+=0.02;
  requestAnimationFrame(draw);
}
draw();

document.addEventListener("pointerdown",()=>ctx.resume(),{once:true});
</script>

</body>
</html>
